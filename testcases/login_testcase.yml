
config:
    name: "登陆流程"
    variables:
      username: ${ENV(USERNAME)}
      is_superuser: ${is_superuser()}
    base_url: ${ENV(BASEURL)}

teststeps:
-
    name: login step 1
    api: api/login.yml
    extract:
      - username: content.data.username
    validate:
      - eq: [headers.Content-Type,application/json]
      - eq: [content.code,200]
      - eq: [content.data.username,$username]
-
    name: login step 2-get login user
    api: api/get-login-user.yml
    validate:
      - eq: [headers.Content-Type,application/json]
      - eq: [content.code,200]
      - eq: [content.msg,'']
      - eq: [content.data.is_superuser,$is_superuser]
      - eq: [content.data.is_staff,True]
      - eq: [content.data.email,$username]

